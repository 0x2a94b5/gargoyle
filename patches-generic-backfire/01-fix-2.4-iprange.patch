--- /dev/null	2010-06-10 18:24:01.975813682 -0400
+++ brcm-old/package/iptables/patches/649-iprange-linux-2.4-compat.patch	2010-06-19 15:19:10.044453229 -0400
@@ -0,0 +1,22 @@
+--- iptables-1.4.6/orig-extensions/libxt_iprange.c	2010-06-19 14:25:37.094454676 -0400
++++ iptables-1.4.6/extensions/libxt_iprange.c	2010-06-19 13:49:28.054453307 -0400
+@@ -96,6 +96,8 @@
+ 		if (invert)
+ 			info->flags |= IPRANGE_SRC_INV;
+ 		iprange_parse_range(optarg, range, NFPROTO_IPV4, "--src-range");
++		(info->src).min_ip = (u_int32_t)range[0].in.s_addr;
++		(info->src).max_ip = (u_int32_t)range[1].in.s_addr;
+ 
+ 		break;
+ 
+@@ -110,7 +112,9 @@
+ 		if (invert)
+ 			info->flags |= IPRANGE_DST_INV;
+ 
+-		iprange_parse_range(optarg, range, NFPROTO_IPV4, "--src-range");
++		iprange_parse_range(optarg, range, NFPROTO_IPV4, "--dst-range");
++		(info->dst).min_ip = (u_int32_t)range[0].in.s_addr;
++		(info->dst).max_ip = (u_int32_t)range[1].in.s_addr;
+ 
+ 		break;
+ 
